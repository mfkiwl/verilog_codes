TODO: The simulation is weird.. sometime the response of the reading is in
the same cycle..
